---
title: "Eurobarometre 1989 - Europe "
output: html_document
date: '2023-05-12'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

# Importation des bases de données

v6 pondération

## Conversion stata vers R
Les bases de données Stata sont importées et converties pour être lues par R. On filtre pour ne travailler tout d'abord que sur la France.

```{r importation données, echo=FALSE}
setwd('/Users/126862/')
Sys.setlocale("LC_ALL", "fr_FR.UTF-8")
library(haven)
eurobarometre1989 <- read_dta("Downloads/ZA1752_v1-1-0.dta")
eurobarometre1989_be <- subset(eurobarometre1989, eurobarometre1989$isocntry == "BE")
eurobarometre1989_de <- subset(eurobarometre1989, eurobarometre1989$isocntry == "DE")
eurobarometre1989_dk <- subset(eurobarometre1989, eurobarometre1989$isocntry == "DK")
eurobarometre1989_es <- subset(eurobarometre1989, eurobarometre1989$isocntry == "ES")
eurobarometre1989_fr <- subset(eurobarometre1989, eurobarometre1989$isocntry == "FR")
eurobarometre1989_gb <- subset(eurobarometre1989, eurobarometre1989$isocntry == "GB")
eurobarometre1989_gr <- subset(eurobarometre1989, eurobarometre1989$isocntry == "GR")
eurobarometre1989_ie <- subset(eurobarometre1989, eurobarometre1989$isocntry == "IE")
eurobarometre1989_it <- subset(eurobarometre1989, eurobarometre1989$isocntry == "IT")
eurobarometre1989_lu <- subset(eurobarometre1989, eurobarometre1989$isocntry == "LU")
eurobarometre1989_nl <- subset(eurobarometre1989, eurobarometre1989$isocntry == "NL")
eurobarometre1989_pt <- subset(eurobarometre1989, eurobarometre1989$isocntry == "PT")
```

# Belgique

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r be de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_be$v1185 en obligationVaccinale_rec
eurobarometre1989_be$obligationVaccinale_rec <- eurobarometre1989_be$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_be$obligationVaccinale_rec <- relevel (eurobarometre1989_be$obligationVaccinale_rec, "0")

summary(eurobarometre1989_be$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r be de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_be$v1185 en importanceVaccin_rec
eurobarometre1989_be$importanceVaccin_rec <- eurobarometre1989_be$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_be$importanceVaccin_rec <- relevel (eurobarometre1989_be$importanceVaccin_rec, "0")
summary(eurobarometre1989_be$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r be de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_be$v1187 into eurobarometre1989_be$v1187_rec
eurobarometre1989_be$diphterie_rec <- eurobarometre1989_be$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_be$v1185 en importanceVaccin_rec
eurobarometre1989_be$diphterie_rec<- relevel (eurobarometre1989_be$diphterie_rec, "0")
summary(eurobarometre1989_be$diphterie_rec)
```

#### Tétanos

```{r be de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_be$v1188 into eurobarometre1989_be$tetanos_rec
eurobarometre1989_be$tetanos_rec <- eurobarometre1989_be$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_be$tetanos_rec<- relevel (eurobarometre1989_be$tetanos_rec, "0")
summary(eurobarometre1989_be$tetanos_rec)
```

#### Rubéole

```{r be de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_be$v1189 into eurobarometre1989_be$rubeole_rec
eurobarometre1989_be$rubeole_rec <- eurobarometre1989_be$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_be$rubeole_rec<- relevel (eurobarometre1989_be$rubeole_rec, "0")
summary(eurobarometre1989_be$rubeole_rec)
```

#### Rougeole

```{r be de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_be$rougeole_rec <- eurobarometre1989_be$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_be$rougeole_rec<- relevel (eurobarometre1989_be$rougeole_rec, "0")
summary(eurobarometre1989_be$rougeole_rec)
```

#### Coqueluche


```{r be de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_be$v1191 into eurobarometre1989_be$coqueluche_rec
eurobarometre1989_be$coqueluche_rec <- eurobarometre1989_be$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_be$coqueluche_rec<- relevel (eurobarometre1989_be$coqueluche_rec, "0")
summary(eurobarometre1989_be$coqueluche_rec)
```

#### Polio

```{r be de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_be$v1192 into eurobarometre1989_be$polio_rec
eurobarometre1989_be$polio_rec <- eurobarometre1989_be$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_be$polio_rec<- relevel (eurobarometre1989_be$polio_rec, "0")
summary(eurobarometre1989_be$polio_rec)

```

### Sexe 


```{r be de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_be$v1311 into eurobarometre1989_be$v1311_rec
eurobarometre1989_be$sexe <- eurobarometre1989_be$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r be de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_be$v1312 into eurobarometre1989_be$age
eurobarometre1989_be$age <- eurobarometre1989_be$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r be de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_be$SexeAge <- case_when(
  eurobarometre1989_be$age == "18-24" & eurobarometre1989_be$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_be$age == "25-34" & eurobarometre1989_be$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_be$age == "35-44"& eurobarometre1989_be$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_be$age == "45-54" & eurobarometre1989_be$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_be$age == "55-64" & eurobarometre1989_be$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_be$age ==  "65-75" & eurobarometre1989_be$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_be$age == "18-24" & eurobarometre1989_be$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_be$age == "25-34" & eurobarometre1989_be$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_be$age == "35-44"& eurobarometre1989_be$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_be$age == "45-54" & eurobarometre1989_be$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_be$age == "55-64" & eurobarometre1989_be$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_be$age ==  "65-75" & eurobarometre1989_be$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_be$SexeAge <- as.factor(eurobarometre1989_be$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r be de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_be$v1310 into eurobarometre1989_be$v1310_rec
eurobarometre1989_be$Education <- eurobarometre1989_be$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r be de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_be$v1317 into eurobarometre1989_be$v1317_rec
eurobarometre1989_be$Revenu <- eurobarometre1989_be$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r be de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_be$OpinionPolitique <- eurobarometre1989_be$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_be$OpinionPolitique)
eurobarometre1989_be$OpinionPolitique<- relevel (eurobarometre1989_be$OpinionPolitique, "Centre")
eurobarometre1989_be$OpinionPolitique <- as.factor(eurobarometre1989_be$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r be de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_be_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_be, weights = ~eurobarometre1989_be$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r be de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r be de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r be de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r be de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r be de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r be de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r be de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r be de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r be de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r be de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r be de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r be de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r be de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r be de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r be de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r be de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r be de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r be de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r be de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r be de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r be de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r be de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r be de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r be de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r be de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r be de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r be de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r be de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r be de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r be de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r be de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r be de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r be de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r be de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r be de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r be de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r be de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r be de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r be de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r be de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r be de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r be de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r be de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_be_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r be de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r be de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r be de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r be de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r be de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r be de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r be de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r be de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_be_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```



# Allemagne

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_de$v1185 en obligationVaccinale_rec
eurobarometre1989_de$obligationVaccinale_rec <- eurobarometre1989_de$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_de$obligationVaccinale_rec <- relevel (eurobarometre1989_de$obligationVaccinale_rec, "0")

summary(eurobarometre1989_de$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_de$v1185 en importanceVaccin_rec
eurobarometre1989_de$importanceVaccin_rec <- eurobarometre1989_de$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_de$importanceVaccin_rec <- relevel (eurobarometre1989_de$importanceVaccin_rec, "0")
summary(eurobarometre1989_de$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_de$v1187 into eurobarometre1989_de$v1187_rec
eurobarometre1989_de$diphterie_rec <- eurobarometre1989_de$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_de$v1185 en importanceVaccin_rec
eurobarometre1989_de$diphterie_rec<- relevel (eurobarometre1989_de$diphterie_rec, "0")
summary(eurobarometre1989_de$diphterie_rec)
```

#### Tétanos

```{r de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_de$v1188 into eurobarometre1989_de$tetanos_rec
eurobarometre1989_de$tetanos_rec <- eurobarometre1989_de$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_de$tetanos_rec<- relevel (eurobarometre1989_de$tetanos_rec, "0")
summary(eurobarometre1989_de$tetanos_rec)
```

#### Rubéole

```{r de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_de$v1189 into eurobarometre1989_de$rubeole_rec
eurobarometre1989_de$rubeole_rec <- eurobarometre1989_de$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_de$rubeole_rec<- relevel (eurobarometre1989_de$rubeole_rec, "0")
summary(eurobarometre1989_de$rubeole_rec)
```

#### Rougeole

```{r de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_de$rougeole_rec <- eurobarometre1989_de$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_de$rougeole_rec<- relevel (eurobarometre1989_de$rougeole_rec, "0")
summary(eurobarometre1989_de$rougeole_rec)
```

#### Coqueluche


```{r de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_de$v1191 into eurobarometre1989_de$coqueluche_rec
eurobarometre1989_de$coqueluche_rec <- eurobarometre1989_de$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_de$coqueluche_rec<- relevel (eurobarometre1989_de$coqueluche_rec, "0")
summary(eurobarometre1989_de$coqueluche_rec)
```

#### Polio

```{r de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_de$v1192 into eurobarometre1989_de$polio_rec
eurobarometre1989_de$polio_rec <- eurobarometre1989_de$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_de$polio_rec<- relevel (eurobarometre1989_de$polio_rec, "0")
summary(eurobarometre1989_de$polio_rec)

```

### Sexe 


```{r de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_de$v1311 into eurobarometre1989_de$v1311_rec
eurobarometre1989_de$sexe <- eurobarometre1989_de$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_de$v1312 into eurobarometre1989_de$age
eurobarometre1989_de$age <- eurobarometre1989_de$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_de$SexeAge <- case_when(
  eurobarometre1989_de$age == "18-24" & eurobarometre1989_de$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_de$age == "25-34" & eurobarometre1989_de$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_de$age == "35-44"& eurobarometre1989_de$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_de$age == "45-54" & eurobarometre1989_de$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_de$age == "55-64" & eurobarometre1989_de$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_de$age ==  "65-75" & eurobarometre1989_de$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_de$age == "18-24" & eurobarometre1989_de$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_de$age == "25-34" & eurobarometre1989_de$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_de$age == "35-44"& eurobarometre1989_de$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_de$age == "45-54" & eurobarometre1989_de$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_de$age == "55-64" & eurobarometre1989_de$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_de$age ==  "65-75" & eurobarometre1989_de$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_de$SexeAge <- as.factor(eurobarometre1989_de$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_de$v1310 into eurobarometre1989_de$v1310_rec
eurobarometre1989_de$Education <- eurobarometre1989_de$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_de$v1317 into eurobarometre1989_de$v1317_rec
eurobarometre1989_de$Revenu <- eurobarometre1989_de$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_de$OpinionPolitique <- eurobarometre1989_de$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_de$OpinionPolitique)
eurobarometre1989_de$OpinionPolitique<- relevel (eurobarometre1989_de$OpinionPolitique, "Centre")
eurobarometre1989_de$OpinionPolitique <- as.factor(eurobarometre1989_de$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_de_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_de, weights = ~eurobarometre1989_de$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_de_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_de_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Danemark

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r dk de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_dk$v1185 en obligationVaccinale_rec
eurobarometre1989_dk$obligationVaccinale_rec <- eurobarometre1989_dk$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$obligationVaccinale_rec <- relevel (eurobarometre1989_dk$obligationVaccinale_rec, "0")

summary(eurobarometre1989_dk$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r dk de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_dk$v1185 en importanceVaccin_rec
eurobarometre1989_dk$importanceVaccin_rec <- eurobarometre1989_dk$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$importanceVaccin_rec <- relevel (eurobarometre1989_dk$importanceVaccin_rec, "0")
summary(eurobarometre1989_dk$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r dk de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_dk$v1187 into eurobarometre1989_dk$v1187_rec
eurobarometre1989_dk$diphterie_rec <- eurobarometre1989_dk$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_dk$v1185 en importanceVaccin_rec
eurobarometre1989_dk$diphterie_rec<- relevel (eurobarometre1989_dk$diphterie_rec, "0")
summary(eurobarometre1989_dk$diphterie_rec)
```

#### Tétanos

```{r dk de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_dk$v1188 into eurobarometre1989_dk$tetanos_rec
eurobarometre1989_dk$tetanos_rec <- eurobarometre1989_dk$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$tetanos_rec<- relevel (eurobarometre1989_dk$tetanos_rec, "0")
summary(eurobarometre1989_dk$tetanos_rec)
```

#### Rubéole

```{r dk de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_dk$v1189 into eurobarometre1989_dk$rubeole_rec
eurobarometre1989_dk$rubeole_rec <- eurobarometre1989_dk$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$rubeole_rec<- relevel (eurobarometre1989_dk$rubeole_rec, "0")
summary(eurobarometre1989_dk$rubeole_rec)
```

#### Rougeole

```{r dk de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_dk$rougeole_rec <- eurobarometre1989_dk$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$rougeole_rec<- relevel (eurobarometre1989_dk$rougeole_rec, "0")
summary(eurobarometre1989_dk$rougeole_rec)
```

#### Coqueluche


```{r dk de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_dk$v1191 into eurobarometre1989_dk$coqueluche_rec
eurobarometre1989_dk$coqueluche_rec <- eurobarometre1989_dk$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$coqueluche_rec<- relevel (eurobarometre1989_dk$coqueluche_rec, "0")
summary(eurobarometre1989_dk$coqueluche_rec)
```

#### Polio

```{r dk de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_dk$v1192 into eurobarometre1989_dk$polio_rec
eurobarometre1989_dk$polio_rec <- eurobarometre1989_dk$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_dk$polio_rec<- relevel (eurobarometre1989_dk$polio_rec, "0")
summary(eurobarometre1989_dk$polio_rec)

```

### Sexe 


```{r dk de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_dk$v1311 into eurobarometre1989_dk$v1311_rec
eurobarometre1989_dk$sexe <- eurobarometre1989_dk$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r dk de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_dk$v1312 into eurobarometre1989_dk$age
eurobarometre1989_dk$age <- eurobarometre1989_dk$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r dk de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_dk$SexeAge <- case_when(
  eurobarometre1989_dk$age == "18-24" & eurobarometre1989_dk$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_dk$age == "25-34" & eurobarometre1989_dk$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_dk$age == "35-44"& eurobarometre1989_dk$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_dk$age == "45-54" & eurobarometre1989_dk$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_dk$age == "55-64" & eurobarometre1989_dk$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_dk$age ==  "65-75" & eurobarometre1989_dk$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_dk$age == "18-24" & eurobarometre1989_dk$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_dk$age == "25-34" & eurobarometre1989_dk$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_dk$age == "35-44"& eurobarometre1989_dk$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_dk$age == "45-54" & eurobarometre1989_dk$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_dk$age == "55-64" & eurobarometre1989_dk$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_dk$age ==  "65-75" & eurobarometre1989_dk$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_dk$SexeAge <- as.factor(eurobarometre1989_dk$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r dk de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_dk$v1310 into eurobarometre1989_dk$v1310_rec
eurobarometre1989_dk$Education <- eurobarometre1989_dk$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r dk de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_dk$v1317 into eurobarometre1989_dk$v1317_rec
eurobarometre1989_dk$Revenu <- eurobarometre1989_dk$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r dk de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_dk$OpinionPolitique <- eurobarometre1989_dk$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_dk$OpinionPolitique)
eurobarometre1989_dk$OpinionPolitique<- relevel (eurobarometre1989_dk$OpinionPolitique, "Centre")
eurobarometre1989_dk$OpinionPolitique <- as.factor(eurobarometre1989_dk$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r dk de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_dk_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_dk, weights = ~eurobarometre1989_dk$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r dk de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r dk de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r dk de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r dk de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r dk de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r dk de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r dk de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r dk de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r dk de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r dk de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r dk de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r dk de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r dk de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r dk de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r dk de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r dk de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r dk de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r dk de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r dk de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r dk de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r dk de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r dk de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r dk de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r dk de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r dk de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r dk de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r dk de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r dk de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r dk de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r dk de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r dk de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r dk de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r dk de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r dk de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r dk de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r dk de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r dk de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r dk de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r dk de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r dk de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r dk de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r dk de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r dk de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_dk_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r dk de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r dk de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r dk de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r dk de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r dk de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r dk de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r dk de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r dk de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_dk_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Espagne

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r es de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_es$v1185 en obligationVaccinale_rec
eurobarometre1989_es$obligationVaccinale_rec <- eurobarometre1989_es$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_es$obligationVaccinale_rec <- relevel (eurobarometre1989_es$obligationVaccinale_rec, "0")

summary(eurobarometre1989_es$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r es de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_es$v1185 en importanceVaccin_rec
eurobarometre1989_es$importanceVaccin_rec <- eurobarometre1989_es$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_es$importanceVaccin_rec <- relevel (eurobarometre1989_es$importanceVaccin_rec, "0")
summary(eurobarometre1989_es$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r es de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_es$v1187 into eurobarometre1989_es$v1187_rec
eurobarometre1989_es$diphterie_rec <- eurobarometre1989_es$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_es$v1185 en importanceVaccin_rec
eurobarometre1989_es$diphterie_rec<- relevel (eurobarometre1989_es$diphterie_rec, "0")
summary(eurobarometre1989_es$diphterie_rec)
```

#### Tétanos

```{r es de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_es$v1188 into eurobarometre1989_es$tetanos_rec
eurobarometre1989_es$tetanos_rec <- eurobarometre1989_es$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_es$tetanos_rec<- relevel (eurobarometre1989_es$tetanos_rec, "0")
summary(eurobarometre1989_es$tetanos_rec)
```

#### Rubéole

```{r es de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_es$v1189 into eurobarometre1989_es$rubeole_rec
eurobarometre1989_es$rubeole_rec <- eurobarometre1989_es$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_es$rubeole_rec<- relevel (eurobarometre1989_es$rubeole_rec, "0")
summary(eurobarometre1989_es$rubeole_rec)
```

#### Rougeole

```{r es de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_es$rougeole_rec <- eurobarometre1989_es$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_es$rougeole_rec<- relevel (eurobarometre1989_es$rougeole_rec, "0")
summary(eurobarometre1989_es$rougeole_rec)
```

#### Coqueluche


```{r es de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_es$v1191 into eurobarometre1989_es$coqueluche_rec
eurobarometre1989_es$coqueluche_rec <- eurobarometre1989_es$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_es$coqueluche_rec<- relevel (eurobarometre1989_es$coqueluche_rec, "0")
summary(eurobarometre1989_es$coqueluche_rec)
```

#### Polio

```{r es de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_es$v1192 into eurobarometre1989_es$polio_rec
eurobarometre1989_es$polio_rec <- eurobarometre1989_es$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_es$polio_rec<- relevel (eurobarometre1989_es$polio_rec, "0")
summary(eurobarometre1989_es$polio_rec)

```

### Sexe 


```{r es de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_es$v1311 into eurobarometre1989_es$v1311_rec
eurobarometre1989_es$sexe <- eurobarometre1989_es$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r es de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_es$v1312 into eurobarometre1989_es$age
eurobarometre1989_es$age <- eurobarometre1989_es$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r es de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_es$SexeAge <- case_when(
  eurobarometre1989_es$age == "18-24" & eurobarometre1989_es$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_es$age == "25-34" & eurobarometre1989_es$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_es$age == "35-44"& eurobarometre1989_es$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_es$age == "45-54" & eurobarometre1989_es$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_es$age == "55-64" & eurobarometre1989_es$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_es$age ==  "65-75" & eurobarometre1989_es$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_es$age == "18-24" & eurobarometre1989_es$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_es$age == "25-34" & eurobarometre1989_es$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_es$age == "35-44"& eurobarometre1989_es$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_es$age == "45-54" & eurobarometre1989_es$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_es$age == "55-64" & eurobarometre1989_es$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_es$age ==  "65-75" & eurobarometre1989_es$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_es$SexeAge <- as.factor(eurobarometre1989_es$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r es de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_es$v1310 into eurobarometre1989_es$v1310_rec
eurobarometre1989_es$Education <- eurobarometre1989_es$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r es de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_es$v1317 into eurobarometre1989_es$v1317_rec
eurobarometre1989_es$Revenu <- eurobarometre1989_es$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r es de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_es$OpinionPolitique <- eurobarometre1989_es$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_es$OpinionPolitique)
eurobarometre1989_es$OpinionPolitique<- relevel (eurobarometre1989_es$OpinionPolitique, "Centre")
eurobarometre1989_es$OpinionPolitique <- as.factor(eurobarometre1989_es$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r es de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_es_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_es, weights = ~eurobarometre1989_es$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r es de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r es de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r es de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r es de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r es de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r es de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r es de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r es de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r es de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r es de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r es de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r es de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r es de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r es de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r es de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r es de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r es de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r es de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r es de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r es de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r es de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r es de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r es de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r es de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r es de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r es de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r es de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r es de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r es de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r es de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r es de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r es de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r es de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r es de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r es de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r es de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r es de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r es de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r es de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r es de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r es de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r es de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r es de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_es_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r es de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r es de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r es de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r es de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r es de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r es de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r es de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r es de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_es_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Grande-Bretagne

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r gb de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_gb$v1185 en obligationVaccinale_rec
eurobarometre1989_gb$obligationVaccinale_rec <- eurobarometre1989_gb$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$obligationVaccinale_rec <- relevel (eurobarometre1989_gb$obligationVaccinale_rec, "0")

summary(eurobarometre1989_gb$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r gb de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_gb$v1185 en importanceVaccin_rec
eurobarometre1989_gb$importanceVaccin_rec <- eurobarometre1989_gb$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$importanceVaccin_rec <- relevel (eurobarometre1989_gb$importanceVaccin_rec, "0")
summary(eurobarometre1989_gb$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r gb de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_gb$v1187 into eurobarometre1989_gb$v1187_rec
eurobarometre1989_gb$diphterie_rec <- eurobarometre1989_gb$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_gb$v1185 en importanceVaccin_rec
eurobarometre1989_gb$diphterie_rec<- relevel (eurobarometre1989_gb$diphterie_rec, "0")
summary(eurobarometre1989_gb$diphterie_rec)
```

#### Tétanos

```{r gb de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gb$v1188 into eurobarometre1989_gb$tetanos_rec
eurobarometre1989_gb$tetanos_rec <- eurobarometre1989_gb$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$tetanos_rec<- relevel (eurobarometre1989_gb$tetanos_rec, "0")
summary(eurobarometre1989_gb$tetanos_rec)
```

#### Rubéole

```{r gb de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gb$v1189 into eurobarometre1989_gb$rubeole_rec
eurobarometre1989_gb$rubeole_rec <- eurobarometre1989_gb$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$rubeole_rec<- relevel (eurobarometre1989_gb$rubeole_rec, "0")
summary(eurobarometre1989_gb$rubeole_rec)
```

#### Rougeole

```{r gb de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_gb$rougeole_rec <- eurobarometre1989_gb$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$rougeole_rec<- relevel (eurobarometre1989_gb$rougeole_rec, "0")
summary(eurobarometre1989_gb$rougeole_rec)
```

#### Coqueluche


```{r gb de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gb$v1191 into eurobarometre1989_gb$coqueluche_rec
eurobarometre1989_gb$coqueluche_rec <- eurobarometre1989_gb$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$coqueluche_rec<- relevel (eurobarometre1989_gb$coqueluche_rec, "0")
summary(eurobarometre1989_gb$coqueluche_rec)
```

#### Polio

```{r gb de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gb$v1192 into eurobarometre1989_gb$polio_rec
eurobarometre1989_gb$polio_rec <- eurobarometre1989_gb$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gb$polio_rec<- relevel (eurobarometre1989_gb$polio_rec, "0")
summary(eurobarometre1989_gb$polio_rec)

```

### Sexe 


```{r gb de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gb$v1311 into eurobarometre1989_gb$v1311_rec
eurobarometre1989_gb$sexe <- eurobarometre1989_gb$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r gb de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gb$v1312 into eurobarometre1989_gb$age
eurobarometre1989_gb$age <- eurobarometre1989_gb$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r gb de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_gb$SexeAge <- case_when(
  eurobarometre1989_gb$age == "18-24" & eurobarometre1989_gb$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_gb$age == "25-34" & eurobarometre1989_gb$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_gb$age == "35-44"& eurobarometre1989_gb$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_gb$age == "45-54" & eurobarometre1989_gb$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_gb$age == "55-64" & eurobarometre1989_gb$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_gb$age ==  "65-75" & eurobarometre1989_gb$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_gb$age == "18-24" & eurobarometre1989_gb$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_gb$age == "25-34" & eurobarometre1989_gb$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_gb$age == "35-44"& eurobarometre1989_gb$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_gb$age == "45-54" & eurobarometre1989_gb$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_gb$age == "55-64" & eurobarometre1989_gb$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_gb$age ==  "65-75" & eurobarometre1989_gb$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_gb$SexeAge <- as.factor(eurobarometre1989_gb$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r gb de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_gb$v1310 into eurobarometre1989_gb$v1310_rec
eurobarometre1989_gb$Education <- eurobarometre1989_gb$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r gb de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_gb$v1317 into eurobarometre1989_gb$v1317_rec
eurobarometre1989_gb$Revenu <- eurobarometre1989_gb$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r gb de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_gb$OpinionPolitique <- eurobarometre1989_gb$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_gb$OpinionPolitique)
eurobarometre1989_gb$OpinionPolitique<- relevel (eurobarometre1989_gb$OpinionPolitique, "Centre")
eurobarometre1989_gb$OpinionPolitique <- as.factor(eurobarometre1989_gb$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r gb de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_gb_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_gb, weights = ~eurobarometre1989_gb$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r gb de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r gb de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r gb de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r gb de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r gb de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r gb de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r gb de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r gb de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r gb de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r gb de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r gb de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r gb de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r gb de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r gb de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r gb de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r gb de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r gb de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r gb de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r gb de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r gb de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r gb de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r gb de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r gb de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r gb de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r gb de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r gb de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r gb de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r gb de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r gb de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r gb de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r gb de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r gb de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r gb de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r gb de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r gb de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r gb de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r gb de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r gb de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r gb de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r gb de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r gb de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r gb de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r gb de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gb_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r gb de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r gb de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r gb de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r gb de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r gb de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r gb de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r gb de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r gb de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gb_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Grèce

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r gr de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_gr$v1185 en obligationVaccinale_rec
eurobarometre1989_gr$obligationVaccinale_rec <- eurobarometre1989_gr$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$obligationVaccinale_rec <- relevel (eurobarometre1989_gr$obligationVaccinale_rec, "0")

summary(eurobarometre1989_gr$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r gr de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_gr$v1185 en importanceVaccin_rec
eurobarometre1989_gr$importanceVaccin_rec <- eurobarometre1989_gr$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$importanceVaccin_rec <- relevel (eurobarometre1989_gr$importanceVaccin_rec, "0")
summary(eurobarometre1989_gr$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r gr de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_gr$v1187 into eurobarometre1989_gr$v1187_rec
eurobarometre1989_gr$diphterie_rec <- eurobarometre1989_gr$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_gr$v1185 en importanceVaccin_rec
eurobarometre1989_gr$diphterie_rec<- relevel (eurobarometre1989_gr$diphterie_rec, "0")
summary(eurobarometre1989_gr$diphterie_rec)
```

#### Tétanos

```{r gr de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gr$v1188 into eurobarometre1989_gr$tetanos_rec
eurobarometre1989_gr$tetanos_rec <- eurobarometre1989_gr$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$tetanos_rec<- relevel (eurobarometre1989_gr$tetanos_rec, "0")
summary(eurobarometre1989_gr$tetanos_rec)
```

#### Rubéole

```{r gr de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gr$v1189 into eurobarometre1989_gr$rubeole_rec
eurobarometre1989_gr$rubeole_rec <- eurobarometre1989_gr$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$rubeole_rec<- relevel (eurobarometre1989_gr$rubeole_rec, "0")
summary(eurobarometre1989_gr$rubeole_rec)
```

#### Rougeole

```{r gr de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_gr$rougeole_rec <- eurobarometre1989_gr$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$rougeole_rec<- relevel (eurobarometre1989_gr$rougeole_rec, "0")
summary(eurobarometre1989_gr$rougeole_rec)
```

#### Coqueluche


```{r gr de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gr$v1191 into eurobarometre1989_gr$coqueluche_rec
eurobarometre1989_gr$coqueluche_rec <- eurobarometre1989_gr$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$coqueluche_rec<- relevel (eurobarometre1989_gr$coqueluche_rec, "0")
summary(eurobarometre1989_gr$coqueluche_rec)
```

#### Polio

```{r gr de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gr$v1192 into eurobarometre1989_gr$polio_rec
eurobarometre1989_gr$polio_rec <- eurobarometre1989_gr$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_gr$polio_rec<- relevel (eurobarometre1989_gr$polio_rec, "0")
summary(eurobarometre1989_gr$polio_rec)

```

### Sexe 


```{r gr de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gr$v1311 into eurobarometre1989_gr$v1311_rec
eurobarometre1989_gr$sexe <- eurobarometre1989_gr$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r gr de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_gr$v1312 into eurobarometre1989_gr$age
eurobarometre1989_gr$age <- eurobarometre1989_gr$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r gr de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_gr$SexeAge <- case_when(
  eurobarometre1989_gr$age == "18-24" & eurobarometre1989_gr$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_gr$age == "25-34" & eurobarometre1989_gr$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_gr$age == "35-44"& eurobarometre1989_gr$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_gr$age == "45-54" & eurobarometre1989_gr$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_gr$age == "55-64" & eurobarometre1989_gr$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_gr$age ==  "65-75" & eurobarometre1989_gr$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_gr$age == "18-24" & eurobarometre1989_gr$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_gr$age == "25-34" & eurobarometre1989_gr$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_gr$age == "35-44"& eurobarometre1989_gr$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_gr$age == "45-54" & eurobarometre1989_gr$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_gr$age == "55-64" & eurobarometre1989_gr$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_gr$age ==  "65-75" & eurobarometre1989_gr$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_gr$SexeAge <- as.factor(eurobarometre1989_gr$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r gr de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_gr$v1310 into eurobarometre1989_gr$v1310_rec
eurobarometre1989_gr$Education <- eurobarometre1989_gr$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r gr de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_gr$v1317 into eurobarometre1989_gr$v1317_rec
eurobarometre1989_gr$Revenu <- eurobarometre1989_gr$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r gr de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_gr$OpinionPolitique <- eurobarometre1989_gr$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_gr$OpinionPolitique)
eurobarometre1989_gr$OpinionPolitique<- relevel (eurobarometre1989_gr$OpinionPolitique, "Centre")
eurobarometre1989_gr$OpinionPolitique <- as.factor(eurobarometre1989_gr$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r gr de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_gr_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_gr, weights = ~eurobarometre1989_gr$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r gr de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r gr de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r gr de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r gr de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r gr de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r gr de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r gr de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r gr de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r gr de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r gr de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r gr de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r gr de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r gr de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r gr de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r gr de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r gr de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r gr de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r gr de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r gr de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r gr de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r gr de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r gr de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r gr de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r gr de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r gr de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r gr de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r gr de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r gr de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r gr de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r gr de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r gr de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r gr de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r gr de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r gr de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r gr de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r gr de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r gr de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r gr de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r gr de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r gr de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r gr de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r gr de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r gr de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_gr_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r gr de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r gr de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r gr de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r gr de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r gr de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r gr de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r gr de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r gr de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_gr_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Irlande

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r ie de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_ie$v1185 en obligationVaccinale_rec
eurobarometre1989_ie$obligationVaccinale_rec <- eurobarometre1989_ie$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$obligationVaccinale_rec <- relevel (eurobarometre1989_ie$obligationVaccinale_rec, "0")

summary(eurobarometre1989_ie$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r ie de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_ie$v1185 en importanceVaccin_rec
eurobarometre1989_ie$importanceVaccin_rec <- eurobarometre1989_ie$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$importanceVaccin_rec <- relevel (eurobarometre1989_ie$importanceVaccin_rec, "0")
summary(eurobarometre1989_ie$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r ie de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_ie$v1187 into eurobarometre1989_ie$v1187_rec
eurobarometre1989_ie$diphterie_rec <- eurobarometre1989_ie$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_ie$v1185 en importanceVaccin_rec
eurobarometre1989_ie$diphterie_rec<- relevel (eurobarometre1989_ie$diphterie_rec, "0")
summary(eurobarometre1989_ie$diphterie_rec)
```

#### Tétanos

```{r ie de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_ie$v1188 into eurobarometre1989_ie$tetanos_rec
eurobarometre1989_ie$tetanos_rec <- eurobarometre1989_ie$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$tetanos_rec<- relevel (eurobarometre1989_ie$tetanos_rec, "0")
summary(eurobarometre1989_ie$tetanos_rec)
```

#### Rubéole

```{r ie de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_ie$v1189 into eurobarometre1989_ie$rubeole_rec
eurobarometre1989_ie$rubeole_rec <- eurobarometre1989_ie$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$rubeole_rec<- relevel (eurobarometre1989_ie$rubeole_rec, "0")
summary(eurobarometre1989_ie$rubeole_rec)
```

#### Rougeole

```{r ie de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_ie$rougeole_rec <- eurobarometre1989_ie$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$rougeole_rec<- relevel (eurobarometre1989_ie$rougeole_rec, "0")
summary(eurobarometre1989_ie$rougeole_rec)
```

#### Coqueluche


```{r ie de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_ie$v1191 into eurobarometre1989_ie$coqueluche_rec
eurobarometre1989_ie$coqueluche_rec <- eurobarometre1989_ie$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$coqueluche_rec<- relevel (eurobarometre1989_ie$coqueluche_rec, "0")
summary(eurobarometre1989_ie$coqueluche_rec)
```

#### Polio

```{r ie de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_ie$v1192 into eurobarometre1989_ie$polio_rec
eurobarometre1989_ie$polio_rec <- eurobarometre1989_ie$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_ie$polio_rec<- relevel (eurobarometre1989_ie$polio_rec, "0")
summary(eurobarometre1989_ie$polio_rec)

```

### Sexe 


```{r ie de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_ie$v1311 into eurobarometre1989_ie$v1311_rec
eurobarometre1989_ie$sexe <- eurobarometre1989_ie$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r ie de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_ie$v1312 into eurobarometre1989_ie$age
eurobarometre1989_ie$age <- eurobarometre1989_ie$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r ie de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_ie$SexeAge <- case_when(
  eurobarometre1989_ie$age == "18-24" & eurobarometre1989_ie$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_ie$age == "25-34" & eurobarometre1989_ie$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_ie$age == "35-44"& eurobarometre1989_ie$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_ie$age == "45-54" & eurobarometre1989_ie$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_ie$age == "55-64" & eurobarometre1989_ie$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_ie$age ==  "65-75" & eurobarometre1989_ie$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_ie$age == "18-24" & eurobarometre1989_ie$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_ie$age == "25-34" & eurobarometre1989_ie$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_ie$age == "35-44"& eurobarometre1989_ie$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_ie$age == "45-54" & eurobarometre1989_ie$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_ie$age == "55-64" & eurobarometre1989_ie$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_ie$age ==  "65-75" & eurobarometre1989_ie$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_ie$SexeAge <- as.factor(eurobarometre1989_ie$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r ie de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_ie$v1310 into eurobarometre1989_ie$v1310_rec
eurobarometre1989_ie$Education <- eurobarometre1989_ie$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r ie de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_ie$v1317 into eurobarometre1989_ie$v1317_rec
eurobarometre1989_ie$Revenu <- eurobarometre1989_ie$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r ie de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_ie$OpinionPolitique <- eurobarometre1989_ie$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_ie$OpinionPolitique)
eurobarometre1989_ie$OpinionPolitique<- relevel (eurobarometre1989_ie$OpinionPolitique, "Centre")
eurobarometre1989_ie$OpinionPolitique <- as.factor(eurobarometre1989_ie$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r ie de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_ie_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_ie, weights = ~eurobarometre1989_ie$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r ie de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r ie de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r ie de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r ie de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r ie de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r ie de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r ie de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r ie de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r ie de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r ie de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r ie de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r ie de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r ie de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r ie de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r ie de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r ie de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r ie de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r ie de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r ie de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r ie de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r ie de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r ie de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r ie de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r ie de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r ie de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r ie de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r ie de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r ie de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r ie de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r ie de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r ie de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r ie de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r ie de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r ie de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r ie de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r ie de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r ie de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r ie de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r ie de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r ie de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r ie de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r ie de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r ie de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_ie_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r ie de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r ie de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r ie de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r ie de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r ie de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r ie de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r ie de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r ie de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_ie_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Italie

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r it de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_it$v1185 en obligationVaccinale_rec
eurobarometre1989_it$obligationVaccinale_rec <- eurobarometre1989_it$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_it$obligationVaccinale_rec <- relevel (eurobarometre1989_it$obligationVaccinale_rec, "0")

summary(eurobarometre1989_it$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r it de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_it$v1185 en importanceVaccin_rec
eurobarometre1989_it$importanceVaccin_rec <- eurobarometre1989_it$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_it$importanceVaccin_rec <- relevel (eurobarometre1989_it$importanceVaccin_rec, "0")
summary(eurobarometre1989_it$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r it de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_it$v1187 into eurobarometre1989_it$v1187_rec
eurobarometre1989_it$diphterie_rec <- eurobarometre1989_it$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_it$v1185 en importanceVaccin_rec
eurobarometre1989_it$diphterie_rec<- relevel (eurobarometre1989_it$diphterie_rec, "0")
summary(eurobarometre1989_it$diphterie_rec)
```

#### Tétanos

```{r it de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_it$v1188 into eurobarometre1989_it$tetanos_rec
eurobarometre1989_it$tetanos_rec <- eurobarometre1989_it$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_it$tetanos_rec<- relevel (eurobarometre1989_it$tetanos_rec, "0")
summary(eurobarometre1989_it$tetanos_rec)
```

#### Rubéole

```{r it de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_it$v1189 into eurobarometre1989_it$rubeole_rec
eurobarometre1989_it$rubeole_rec <- eurobarometre1989_it$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_it$rubeole_rec<- relevel (eurobarometre1989_it$rubeole_rec, "0")
summary(eurobarometre1989_it$rubeole_rec)
```

#### Rougeole

```{r it de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_it$rougeole_rec <- eurobarometre1989_it$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_it$rougeole_rec<- relevel (eurobarometre1989_it$rougeole_rec, "0")
summary(eurobarometre1989_it$rougeole_rec)
```

#### Coqueluche


```{r it de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_it$v1191 into eurobarometre1989_it$coqueluche_rec
eurobarometre1989_it$coqueluche_rec <- eurobarometre1989_it$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_it$coqueluche_rec<- relevel (eurobarometre1989_it$coqueluche_rec, "0")
summary(eurobarometre1989_it$coqueluche_rec)
```

#### Polio

```{r it de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_it$v1192 into eurobarometre1989_it$polio_rec
eurobarometre1989_it$polio_rec <- eurobarometre1989_it$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_it$polio_rec<- relevel (eurobarometre1989_it$polio_rec, "0")
summary(eurobarometre1989_it$polio_rec)

```

### Sexe 


```{r it de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_it$v1311 into eurobarometre1989_it$v1311_rec
eurobarometre1989_it$sexe <- eurobarometre1989_it$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r it de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_it$v1312 into eurobarometre1989_it$age
eurobarometre1989_it$age <- eurobarometre1989_it$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r it de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_it$SexeAge <- case_when(
  eurobarometre1989_it$age == "18-24" & eurobarometre1989_it$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_it$age == "25-34" & eurobarometre1989_it$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_it$age == "35-44"& eurobarometre1989_it$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_it$age == "45-54" & eurobarometre1989_it$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_it$age == "55-64" & eurobarometre1989_it$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_it$age ==  "65-75" & eurobarometre1989_it$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_it$age == "18-24" & eurobarometre1989_it$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_it$age == "25-34" & eurobarometre1989_it$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_it$age == "35-44"& eurobarometre1989_it$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_it$age == "45-54" & eurobarometre1989_it$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_it$age == "55-64" & eurobarometre1989_it$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_it$age ==  "65-75" & eurobarometre1989_it$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_it$SexeAge <- as.factor(eurobarometre1989_it$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r it de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_it$v1310 into eurobarometre1989_it$v1310_rec
eurobarometre1989_it$Education <- eurobarometre1989_it$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r it de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_it$v1317 into eurobarometre1989_it$v1317_rec
eurobarometre1989_it$Revenu <- eurobarometre1989_it$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r it de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_it$OpinionPolitique <- eurobarometre1989_it$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_it$OpinionPolitique)
eurobarometre1989_it$OpinionPolitique<- relevel (eurobarometre1989_it$OpinionPolitique, "Centre")
eurobarometre1989_it$OpinionPolitique <- as.factor(eurobarometre1989_it$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r it de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_it_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_it, weights = ~eurobarometre1989_it$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r it de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r it de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r it de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r it de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r it de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r it de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r it de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r it de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r it de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r it de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r it de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r it de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r it de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r it de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r it de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r it de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r it de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r it de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r it de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r it de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r it de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r it de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r it de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r it de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r it de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r it de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r it de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r it de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r it de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r it de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r it de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r it de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r it de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r it de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r it de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r it de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r it de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r it de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r it de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r it de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r it de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r it de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r it de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_it_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r it de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r it de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r it de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r it de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r it de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r it de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r it de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r it de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_it_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Luxembourg

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r lu de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_lu$v1185 en obligationVaccinale_rec
eurobarometre1989_lu$obligationVaccinale_rec <- eurobarometre1989_lu$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$obligationVaccinale_rec <- relevel (eurobarometre1989_lu$obligationVaccinale_rec, "0")

summary(eurobarometre1989_lu$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r lu de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_lu$v1185 en importanceVaccin_rec
eurobarometre1989_lu$importanceVaccin_rec <- eurobarometre1989_lu$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$importanceVaccin_rec <- relevel (eurobarometre1989_lu$importanceVaccin_rec, "0")
summary(eurobarometre1989_lu$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r lu de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_lu$v1187 into eurobarometre1989_lu$v1187_rec
eurobarometre1989_lu$diphterie_rec <- eurobarometre1989_lu$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_lu$v1185 en importanceVaccin_rec
eurobarometre1989_lu$diphterie_rec<- relevel (eurobarometre1989_lu$diphterie_rec, "0")
summary(eurobarometre1989_lu$diphterie_rec)
```

#### Tétanos

```{r lu de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_lu$v1188 into eurobarometre1989_lu$tetanos_rec
eurobarometre1989_lu$tetanos_rec <- eurobarometre1989_lu$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$tetanos_rec<- relevel (eurobarometre1989_lu$tetanos_rec, "0")
summary(eurobarometre1989_lu$tetanos_rec)
```

#### Rubéole

```{r lu de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_lu$v1189 into eurobarometre1989_lu$rubeole_rec
eurobarometre1989_lu$rubeole_rec <- eurobarometre1989_lu$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$rubeole_rec<- relevel (eurobarometre1989_lu$rubeole_rec, "0")
summary(eurobarometre1989_lu$rubeole_rec)
```

#### Rougeole

```{r lu de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_lu$rougeole_rec <- eurobarometre1989_lu$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$rougeole_rec<- relevel (eurobarometre1989_lu$rougeole_rec, "0")
summary(eurobarometre1989_lu$rougeole_rec)
```

#### Coqueluche


```{r lu de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_lu$v1191 into eurobarometre1989_lu$coqueluche_rec
eurobarometre1989_lu$coqueluche_rec <- eurobarometre1989_lu$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$coqueluche_rec<- relevel (eurobarometre1989_lu$coqueluche_rec, "0")
summary(eurobarometre1989_lu$coqueluche_rec)
```

#### Polio

```{r lu de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_lu$v1192 into eurobarometre1989_lu$polio_rec
eurobarometre1989_lu$polio_rec <- eurobarometre1989_lu$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_lu$polio_rec<- relevel (eurobarometre1989_lu$polio_rec, "0")
summary(eurobarometre1989_lu$polio_rec)

```

### Sexe 


```{r lu de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_lu$v1311 into eurobarometre1989_lu$v1311_rec
eurobarometre1989_lu$sexe <- eurobarometre1989_lu$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r lu de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_lu$v1312 into eurobarometre1989_lu$age
eurobarometre1989_lu$age <- eurobarometre1989_lu$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r lu de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_lu$SexeAge <- case_when(
  eurobarometre1989_lu$age == "18-24" & eurobarometre1989_lu$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_lu$age == "25-34" & eurobarometre1989_lu$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_lu$age == "35-44"& eurobarometre1989_lu$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_lu$age == "45-54" & eurobarometre1989_lu$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_lu$age == "55-64" & eurobarometre1989_lu$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_lu$age ==  "65-75" & eurobarometre1989_lu$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_lu$age == "18-24" & eurobarometre1989_lu$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_lu$age == "25-34" & eurobarometre1989_lu$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_lu$age == "35-44"& eurobarometre1989_lu$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_lu$age == "45-54" & eurobarometre1989_lu$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_lu$age == "55-64" & eurobarometre1989_lu$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_lu$age ==  "65-75" & eurobarometre1989_lu$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_lu$SexeAge <- as.factor(eurobarometre1989_lu$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r lu de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_lu$v1310 into eurobarometre1989_lu$v1310_rec
eurobarometre1989_lu$Education <- eurobarometre1989_lu$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r lu de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_lu$v1317 into eurobarometre1989_lu$v1317_rec
eurobarometre1989_lu$Revenu <- eurobarometre1989_lu$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r lu de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_lu$OpinionPolitique <- eurobarometre1989_lu$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_lu$OpinionPolitique)
eurobarometre1989_lu$OpinionPolitique<- relevel (eurobarometre1989_lu$OpinionPolitique, "Centre")
eurobarometre1989_lu$OpinionPolitique <- as.factor(eurobarometre1989_lu$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r lu de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_lu_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_lu, weights = ~eurobarometre1989_lu$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r lu de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r lu de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r lu de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r lu de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r lu de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r lu de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r lu de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r lu de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r lu de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r lu de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r lu de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r lu de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r lu de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r lu de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r lu de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r lu de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r lu de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r lu de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r lu de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r lu de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r lu de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r lu de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r lu de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r lu de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r lu de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r lu de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r lu de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r lu de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r lu de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r lu de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r lu de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r lu de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r lu de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r lu de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r lu de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r lu de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r lu de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r lu de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r lu de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r lu de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r lu de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r lu de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r lu de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_lu_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r lu de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r lu de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r lu de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r lu de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r lu de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r lu de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r lu de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r lu de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_lu_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Pays Bas

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r nl de recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_nl$v1185 en obligationVaccinale_rec
eurobarometre1989_nl$obligationVaccinale_rec <- eurobarometre1989_nl$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$obligationVaccinale_rec <- relevel (eurobarometre1989_nl$obligationVaccinale_rec, "0")

summary(eurobarometre1989_nl$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r nl de recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_nl$v1185 en importanceVaccin_rec
eurobarometre1989_nl$importanceVaccin_rec <- eurobarometre1989_nl$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$importanceVaccin_rec <- relevel (eurobarometre1989_nl$importanceVaccin_rec, "0")
summary(eurobarometre1989_nl$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r nl de recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_nl$v1187 into eurobarometre1989_nl$v1187_rec
eurobarometre1989_nl$diphterie_rec <- eurobarometre1989_nl$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_nl$v1185 en importanceVaccin_rec
eurobarometre1989_nl$diphterie_rec<- relevel (eurobarometre1989_nl$diphterie_rec, "0")
summary(eurobarometre1989_nl$diphterie_rec)
```

#### Tétanos

```{r nl de recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_nl$v1188 into eurobarometre1989_nl$tetanos_rec
eurobarometre1989_nl$tetanos_rec <- eurobarometre1989_nl$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$tetanos_rec<- relevel (eurobarometre1989_nl$tetanos_rec, "0")
summary(eurobarometre1989_nl$tetanos_rec)
```

#### Rubéole

```{r nl de recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_nl$v1189 into eurobarometre1989_nl$rubeole_rec
eurobarometre1989_nl$rubeole_rec <- eurobarometre1989_nl$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$rubeole_rec<- relevel (eurobarometre1989_nl$rubeole_rec, "0")
summary(eurobarometre1989_nl$rubeole_rec)
```

#### Rougeole

```{r nl de recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_nl$rougeole_rec <- eurobarometre1989_nl$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$rougeole_rec<- relevel (eurobarometre1989_nl$rougeole_rec, "0")
summary(eurobarometre1989_nl$rougeole_rec)
```

#### Coqueluche


```{r nl de recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_nl$v1191 into eurobarometre1989_nl$coqueluche_rec
eurobarometre1989_nl$coqueluche_rec <- eurobarometre1989_nl$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$coqueluche_rec<- relevel (eurobarometre1989_nl$coqueluche_rec, "0")
summary(eurobarometre1989_nl$coqueluche_rec)
```

#### Polio

```{r nl de recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_nl$v1192 into eurobarometre1989_nl$polio_rec
eurobarometre1989_nl$polio_rec <- eurobarometre1989_nl$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_nl$polio_rec<- relevel (eurobarometre1989_nl$polio_rec, "0")
summary(eurobarometre1989_nl$polio_rec)

```

### Sexe 


```{r nl de recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_nl$v1311 into eurobarometre1989_nl$v1311_rec
eurobarometre1989_nl$sexe <- eurobarometre1989_nl$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r nl de recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_nl$v1312 into eurobarometre1989_nl$age
eurobarometre1989_nl$age <- eurobarometre1989_nl$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r nl de recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_nl$SexeAge <- case_when(
  eurobarometre1989_nl$age == "18-24" & eurobarometre1989_nl$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_nl$age == "25-34" & eurobarometre1989_nl$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_nl$age == "35-44"& eurobarometre1989_nl$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_nl$age == "45-54" & eurobarometre1989_nl$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_nl$age == "55-64" & eurobarometre1989_nl$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_nl$age ==  "65-75" & eurobarometre1989_nl$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_nl$age == "18-24" & eurobarometre1989_nl$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_nl$age == "25-34" & eurobarometre1989_nl$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_nl$age == "35-44"& eurobarometre1989_nl$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_nl$age == "45-54" & eurobarometre1989_nl$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_nl$age == "55-64" & eurobarometre1989_nl$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_nl$age ==  "65-75" & eurobarometre1989_nl$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_nl$SexeAge <- as.factor(eurobarometre1989_nl$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r nl de recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_nl$v1310 into eurobarometre1989_nl$v1310_rec
eurobarometre1989_nl$Education <- eurobarometre1989_nl$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r nl de recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_nl$v1317 into eurobarometre1989_nl$v1317_rec
eurobarometre1989_nl$Revenu <- eurobarometre1989_nl$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r nl de Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_nl$OpinionPolitique <- eurobarometre1989_nl$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_nl$OpinionPolitique)
eurobarometre1989_nl$OpinionPolitique<- relevel (eurobarometre1989_nl$OpinionPolitique, "Centre")
eurobarometre1989_nl$OpinionPolitique <- as.factor(eurobarometre1989_nl$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r nl de pondération données, echo=FALSE}
library(survey)
eurobarometre1989_nl_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_nl, weights = ~eurobarometre1989_nl$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r nl de tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r nl de tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r nl de tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r nl de tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r nl de tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r nl de tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r nl de tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r nl de tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r nl de tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r nl de tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r nl de tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r nl de tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r nl de tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r nl de tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r nl de tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r nl de tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r nl de tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r nl de tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r nl de tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r nl de tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r nl de tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r nl de tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r nl de tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r nl de tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r nl de tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r nl de tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r nl de tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r nl de tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r nl de tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r nl de tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r nl de tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r nl de tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r nl de tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r nl de tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r nl de tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r nl de tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r nl de tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r nl de tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r nl de tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r nl de tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r nl de tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r nl de tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r nl de tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_nl_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r nl de régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r nl de régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r nl de régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r nl de régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r nl de régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r nl de régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r nl de régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r nl de régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_nl_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

# Portugal

## Recodage des variables

### Obligation vaccinale

Certaines vaccinations sont obligatoires. Cela vous paraît-il ... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r ptde recodage obligation vaccinale, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_pt$v1185 en obligationVaccinale_rec
eurobarometre1989_pt$obligationVaccinale_rec <- eurobarometre1989_pt$v1185 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$obligationVaccinale_rec <- relevel (eurobarometre1989_pt$obligationVaccinale_rec, "0")

summary(eurobarometre1989_pt$obligationVaccinale_rec)
```

(NSP= 0 visiblement)

### Importance de se faire vacciner

Dans quelle mesure est-il à vos yeux important de se faire vacciner de façon régulière ? Est-ce... ?

1 = très important
2 = assez important
3 = pas très important
4 = pas important du tout
5 = NSP


```{r ptde recodage importance des vaccins, echo=FALSE}
library(questionr)
library(forcats)
## Recoder eurobarometre1989_pt$v1185 en importanceVaccin_rec
eurobarometre1989_pt$importanceVaccin_rec <- eurobarometre1989_pt$v1186 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "0" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$importanceVaccin_rec <- relevel (eurobarometre1989_pt$importanceVaccin_rec, "0")
summary(eurobarometre1989_pt$importanceVaccin_rec)
```

### Vaccins spécifiques

Voici une série de vaccinations. Pour chacune d'entre elles : vous paraît-elle ... ?

1 = indispensable
2 = nécessaire
3 = souhaitable
4 = pas essentielle
5 = NSP

#### Diphtérie


```{r ptde recodage diphtérie, echo=FALSE}
library(questionr)
library(forcats)## Recoding eurobarometre1989_pt$v1187 into eurobarometre1989_pt$v1187_rec
eurobarometre1989_pt$diphterie_rec <- eurobarometre1989_pt$v1187 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
## Recoder eurobarometre1989_pt$v1185 en importanceVaccin_rec
eurobarometre1989_pt$diphterie_rec<- relevel (eurobarometre1989_pt$diphterie_rec, "0")
summary(eurobarometre1989_pt$diphterie_rec)
```

#### Tétanos

```{r ptde recodage tétanos, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_pt$v1188 into eurobarometre1989_pt$tetanos_rec
eurobarometre1989_pt$tetanos_rec <- eurobarometre1989_pt$v1188 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$tetanos_rec<- relevel (eurobarometre1989_pt$tetanos_rec, "0")
summary(eurobarometre1989_pt$tetanos_rec)
```

#### Rubéole

```{r ptde recodage rubéole, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_pt$v1189 into eurobarometre1989_pt$rubeole_rec
eurobarometre1989_pt$rubeole_rec <- eurobarometre1989_pt$v1189 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$rubeole_rec<- relevel (eurobarometre1989_pt$rubeole_rec, "0")
summary(eurobarometre1989_pt$rubeole_rec)
```

#### Rougeole

```{r ptde recodage rougeoles, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989$v1190 into eurobarometre1989$rougeole_rec
eurobarometre1989_pt$rougeole_rec <- eurobarometre1989_pt$v1190 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$rougeole_rec<- relevel (eurobarometre1989_pt$rougeole_rec, "0")
summary(eurobarometre1989_pt$rougeole_rec)
```

#### Coqueluche


```{r ptde recodage coqueluche, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_pt$v1191 into eurobarometre1989_pt$coqueluche_rec
eurobarometre1989_pt$coqueluche_rec <- eurobarometre1989_pt$v1191 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$coqueluche_rec<- relevel (eurobarometre1989_pt$coqueluche_rec, "0")
summary(eurobarometre1989_pt$coqueluche_rec)
```

#### Polio

```{r ptde recodage polio, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_pt$v1192 into eurobarometre1989_pt$polio_rec
eurobarometre1989_pt$polio_rec <- eurobarometre1989_pt$v1192 %>%
  as.character() %>%
  fct_recode(
    "1" = "2",
    "1" = "3",
    "0" = "4"
  )
eurobarometre1989_pt$polio_rec<- relevel (eurobarometre1989_pt$polio_rec, "0")
summary(eurobarometre1989_pt$polio_rec)

```

### Sexe 


```{r ptde recodage sexe, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_pt$v1311 into eurobarometre1989_pt$v1311_rec
eurobarometre1989_pt$sexe <- eurobarometre1989_pt$v1311 %>%
  as.character() %>%
  fct_recode(
    "Homme" = "1",
    "Femme" = "2"
  )

```

### Age

```{r ptde recodage age, echo=FALSE}
library(questionr)
library(forcats)
## Recoding eurobarometre1989_pt$v1312 into eurobarometre1989_pt$age
eurobarometre1989_pt$age <- eurobarometre1989_pt$v1312 %>%
    as.character() %>%
  fct_recode(
    NULL = "15",
    NULL = "16",
    NULL = "17",
    "18-24" = "18",
    "18-24" = "19",
    "18-24" = "20",
    "18-24" = "21",
    "18-24" = "22",
    "18-24" = "23",
    "18-24" = "24",
    "25-34" = "25",
    "25-34" = "26",
    "25-34" = "27",
    "25-34" = "28",
    "25-34" = "29",
    "25-34" = "30",
    "25-34" = "31",
    "25-34" = "32",
    "25-34" = "33",
    "25-34" = "34",
    "35-44" = "35",
    "35-44" = "36",
    "35-44" = "37",
    "35-44" = "38",
    "35-44" = "39",
    "35-44" = "40",
    "35-44" = "41",
    "35-44" = "42",
    "35-44" = "43",
    "35-44" = "44",
    "45-54" = "45",
    "45-54" = "46",
    "45-54" = "47",
    "45-54" = "48",
    "45-54" = "49",
    "45-54" = "50",
    "45-54" = "51",
    "45-54" = "52",
    "45-54" = "53",
    "45-54" = "54",
    "55-64" = "55",
    "55-64" = "56",
    "55-64" = "57",
    "55-64" = "58",
    "55-64" = "59",
    "55-64" = "60",
    "55-64" = "61",
    "55-64" = "62",
    "55-64" = "63",
    "55-64" = "64",
    "65-74" = "65",
    "65-74" = "66",
    "65-74" = "67",
    "65-74" = "68",
    "65-74" = "69",
    "65-74" = "70",
    "65-74" = "71",
    "65-74" = "72",
    "65-74" = "73",
    "65-74" = "74",
    NULL = "75",
    NULL = "76",
    NULL = "77",
    NULL = "78",
    NULL = "79",
    NULL = "80",
    NULL = "81",
    NULL = "82",
    NULL = "83",
    NULL = "84",
    NULL = "85",
    NULL = "86",
    NULL = "87",
    NULL = "88",
    NULL = "89",
    NULL = "90",
    NULL = "91",
    NULL = "92",
    NULL = "93",
    NULL = "94"
  )

```

### Interaction sexe age

```{r ptde recodage sexe age, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
eurobarometre1989_pt$SexeAge <- case_when(
  eurobarometre1989_pt$age == "18-24" & eurobarometre1989_pt$v1311 == 2 ~ "Femme 18-24 ans",
  eurobarometre1989_pt$age == "25-34" & eurobarometre1989_pt$v1311 == 2 ~ "Femme 25-34 ans",
  eurobarometre1989_pt$age == "35-44"& eurobarometre1989_pt$v1311 == 2 ~ "Femme 35-44 ans",
  eurobarometre1989_pt$age == "45-54" & eurobarometre1989_pt$v1311 == 2 ~ "Femme 45-54 ans",
  eurobarometre1989_pt$age == "55-64" & eurobarometre1989_pt$v1311 == 2 ~ "Femme 55-64 ans",
  eurobarometre1989_pt$age ==  "65-75" & eurobarometre1989_pt$v1311 == 2 ~ "Femme 65-75 ans",
  eurobarometre1989_pt$age == "18-24" & eurobarometre1989_pt$v1311 == 1 ~ "Homme 18-24 ans",
  eurobarometre1989_pt$age == "25-34" & eurobarometre1989_pt$v1311 == 1 ~ "Homme 25-34 ans",
  eurobarometre1989_pt$age == "35-44"& eurobarometre1989_pt$v1311 == 1 ~ "Homme 35-44 ans",
  eurobarometre1989_pt$age == "45-54" & eurobarometre1989_pt$v1311 == 1 ~ "Homme 45-54 ans",
  eurobarometre1989_pt$age == "55-64" & eurobarometre1989_pt$v1311 == 1 ~ "Homme 55-64 ans",
  eurobarometre1989_pt$age ==  "65-75" & eurobarometre1989_pt$v1311 == 1 ~ "Homme 65-75 ans",
)
eurobarometre1989_pt$SexeAge <- as.factor(eurobarometre1989_pt$SexeAge)

```

### Age à la fin de l'éducation (proxy diplome)

On utilise v1310, recodage de V1309 en modalités adaptées à l'époque.

```{r ptde recodage age fin education, echo=FALSE}
library(forcats)
library(questionr)
## Recoding eurobarometre1989_pt$v1310 into eurobarometre1989_pt$v1310_rec
eurobarometre1989_pt$Education <- eurobarometre1989_pt$v1310 %>%
  as.character() %>%
  fct_recode(
    "- de 15 ans" = "1",
    "16-19 ans" = "2",
    "20 ans et +" = "3",
    "En cours d'études" = "4"
  )
```


### Revenu


Pour permettre la comparabilité entre les pays, leur différentes monnaies et niveaux de revenu, on utilise un recodage en quartiles déjà calculé par l'enquête: v1317 (1 pour les plus riches, 4 pour les moins riches)


```{r ptde recodage revenus, echo=FALSE}
library(forcats)
library(questionr)
library(dplyr)
## Recoding eurobarometre1989_pt$v1317 into eurobarometre1989_pt$v1317_rec
eurobarometre1989_pt$Revenu <- eurobarometre1989_pt$v1317 %>%
  as.character() %>%
  fct_recode(
    "1er quartile (plus riche)" = "1",
    "2eme quartile" = "2",
    "3eme quartile" = "3",
    "4ème quartile" = "4"
  )

```

### Politisation

L'axe choisi dans l'Eurobaromètre pose problème, son centre mathématique se situant à "5,5". Plusieurs options de recodage sont possibles A la suite de Nathalie et Touzet (2019),nous recodons l'axe de 1 (le plus à gauche) à 10 (le plus à droite) de la manière suivante:
Extrême Gauche  = 1-2
Gauche = 3-4
Centre= 5-6
Droite = 7-8,
Droite radicale = 9-10.

Voir: Nathalie, Cyril, et Hugo Touzet. « La gauche et la droite, un clivage persistant », Pierre Bréchon éd., La France des valeurs. Quarante ans d'évolutions. Presses universitaires de Grenoble, 2019, pp. 265-272.

Les partis politiques posent trop de complexité pour la comparaison entre pays.

```{r ptde Opinion Politique, echo=FALSE}
library(forcats)
library(questionr)
## Recodage de eurobarometre2019$OpinionPolitique en eurobarometre2019$d1_rec
eurobarometre1989_pt$OpinionPolitique <- eurobarometre1989_pt$v1292 %>%
  as.character() %>%
  fct_recode(
    "Extrême Gauche" = "1",
    "Extrême Gauche" = "2",
    "Gauche" = "3",
    "Gauche" = "4",
    "Centre" = "5",
    "Centre" = "6",
    "Droite" = "7",
    "Droite" = "8",
    "Extrême droite" = "9",
    "Extrême droite" = "10",
  )
summary(eurobarometre1989_pt$OpinionPolitique)
eurobarometre1989_pt$OpinionPolitique<- relevel (eurobarometre1989_pt$OpinionPolitique, "Centre")
eurobarometre1989_pt$OpinionPolitique <- as.factor(eurobarometre1989_pt$OpinionPolitique)

```


## Application des pondérations

On applique les pondérations suggérées par l'eurobaromètre avec le package survey. La pondération W1 de 2019 correspond à la pondération Nation Weight II dans les enquêtes précédents l'Eurobaromètre 31.

```{r ptde pondération données, echo=FALSE}
library(survey)
eurobarometre1989_pt_Wgt <- svydesign(ids = ~1, data = eurobarometre1989_pt, weights = ~eurobarometre1989_pt$v6)
```


# Calculs


## Statistiques descriptives: variables brutes

### Obligation vaccinale


#### Sexe et Age

```{r ptde tri croisé brutobligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutobligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutobligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r ptde tri croisé brutobligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1185,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r ptde tri croisé brutimportanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutimportanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutimportanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r ptde tri croisé brutimportanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1186,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r ptde tri croisé brutdiphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutdiphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutdiphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r ptde tri croisé brutdiphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1187,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r ptde tri croisé bruttetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé bruttetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r ptde tri croisé bruttetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r ptde tri croisé bruttetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1188,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r ptde tri croisé brutrubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutrubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutrubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r ptde tri croisé brutrubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1189,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r ptde tri croisé brutrougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutrougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutrougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r ptde tri croisé brutrougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1190,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r ptde tri croisé brutcoqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutcoqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutcoqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r ptde tri croisé brutcoqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1191,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r ptde tri croisé brutpolio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé brutpolio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r ptde tri croisé brutpolio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r ptde tri croisé brutpolio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= v1192,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```



## Statistiques descriptives: variables recodées

### Obligation vaccinale


#### Sexe et Age

```{r ptde tri croisé obligationVaccinale sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = SexeAge )
mytable_obligationVaccinale_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé obligationVaccinale age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Education )
mytable_obligationVaccinale_AgeDiplome
```


#### Revenu


```{r ptde tri croisé obligationVaccinale revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = Revenu )
mytable_obligationVaccinale_Revenu
```

#### Politisation


```{r ptde tri croisé obligationVaccinale politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_obligationVaccinale_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= obligationVaccinale_rec,
  include = OpinionPolitique)
mytable_obligationVaccinale_OpinionPolitique
```


### Importance Vaccin


#### Sexe et Age

```{r ptde tri croisé importanceVaccin sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = SexeAge )
mytable_importanceVaccin_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé importanceVaccin age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Education )
mytable_importanceVaccin_AgeDiplome
```


#### Revenu


```{r ptde tri croisé importanceVaccin revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = Revenu )
mytable_importanceVaccin_Revenu
```

#### Politisation


```{r ptde tri croisé importanceVaccin politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_importanceVaccin_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= importanceVaccin_rec,
  include = OpinionPolitique)
mytable_importanceVaccin_OpinionPolitique
```

### Diphterie


#### Sexe et Age

```{r ptde tri croisé diphterie sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = SexeAge )
mytable_diphterie_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé diphterie age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Education )
mytable_diphterie_AgeDiplome
```


#### Revenu


```{r ptde tri croisé diphterie revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = Revenu )
mytable_diphterie_Revenu
```

#### Politisation


```{r ptde tri croisé diphterie politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_diphterie_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= diphterie_rec,
  include = OpinionPolitique)
mytable_diphterie_OpinionPolitique
```

### Tetanos


#### Sexe et Age

```{r ptde tri croisé tetanos sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = SexeAge )
mytable_tetanos_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé tetanos age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Education )
mytable_tetanos_AgeDiplome
```


#### Revenu


```{r ptde tri croisé tetanos revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = Revenu )
mytable_tetanos_Revenu
```

#### Politisation


```{r ptde tri croisé tetanos politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_tetanos_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= tetanos_rec,
  include = OpinionPolitique)
mytable_tetanos_OpinionPolitique
```


### Rubeole


#### Sexe et Age

```{r ptde tri croisé rubeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = SexeAge )
mytable_rubeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé rubeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Education )
mytable_rubeole_AgeDiplome
```


#### Revenu


```{r ptde tri croisé rubeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = Revenu )
mytable_rubeole_Revenu
```

#### Politisation


```{r ptde tri croisé rubeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rubeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rubeole_rec,
  include = OpinionPolitique)
mytable_rubeole_OpinionPolitique
```



### Rougeole


#### Sexe et Age

```{r ptde tri croisé rougeole sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = SexeAge )
mytable_rougeole_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé rougeole age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Education )
mytable_rougeole_AgeDiplome
```


#### Revenu


```{r ptde tri croisé rougeole revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = Revenu )
mytable_rougeole_Revenu
```

#### Politisation


```{r ptde tri croisé rougeole politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_rougeole_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= rougeole_rec,
  include = OpinionPolitique)
mytable_rougeole_OpinionPolitique
```


### Coqueluche


#### Sexe et Age

```{r ptde tri croisé coqueluche sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = SexeAge )
mytable_coqueluche_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé coqueluche age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Education )
mytable_coqueluche_AgeDiplome
```


#### Revenu


```{r ptde tri croisé coqueluche revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = Revenu )
mytable_coqueluche_Revenu
```

#### Politisation


```{r ptde tri croisé coqueluche politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_coqueluche_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= coqueluche_rec,
  include = OpinionPolitique)
mytable_coqueluche_OpinionPolitique
```

### Polio


#### Sexe et Age

```{r ptde tri croisé polio sexe age, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_SexeAge <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = SexeAge )
mytable_polio_SexeAge 
```

#### Age education (proxy diplome)

```{r ptde tri croisé polio age diplome, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_AgeDiplome <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Education )
mytable_polio_AgeDiplome
```


#### Revenu


```{r ptde tri croisé polio revenu, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_Revenu <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = Revenu )
mytable_polio_Revenu
```

#### Politisation


```{r ptde tri croisé polio politisation, echo=FALSE}
library(survey)
library(gtsummary)
mytable_polio_OpinionPolitique <- tbl_svysummary(
  eurobarometre1989_pt_Wgt, 
  missing = "no",
  percent = "row",
  by= polio_rec,
  include = OpinionPolitique)
mytable_polio_OpinionPolitique
```


## Régressions

### Sur Obligation vaccinale

```{r ptde régression obligation vaccinale , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(obligationVaccinale_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Importance vaccins

```{r ptde régression importance vaccins , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(importanceVaccin_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Diphtérie

```{r ptde régression diphtérie , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(diphterie_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Tetanos

```{r ptde régression tétanos , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(tetanos_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```


### Polio

```{r ptde régression polio , echo=FALSE}
library(GGally)
library(forestmodel)
myresult_polio <- svyglm(polio_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult_polio)
summary(myresult_polio)
ggcoef_model(myresult_polio, exponentiate = TRUE)
forest_model(myresult_polio, recalculate_width= TRUE)
```

### Coqueluche

```{r ptde régression coqueluche , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(coqueluche_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rougeole


```{r ptde régression rougeole , echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rougeole_rec ~ SexeAge + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```

### Rubeole

```{r ptde régression rubéole, echo=FALSE}
library(GGally)
library(forestmodel)
myresult <- svyglm(rubeole_rec ~ SexeAge  + Revenu + Education + OpinionPolitique, family = binomial(link=logit), design = eurobarometre1989_pt_Wgt)
coef(myresult)
summary(myresult)
ggcoef_model(myresult, exponentiate = TRUE)
forest_model(myresult, recalculate_width= TRUE)
```



